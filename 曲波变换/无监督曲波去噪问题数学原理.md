### 基于已知支撑集的曲波变换去偏 (Debiasing) —— 精确求解形式

#### 1. 问题背景与性质纠正
在稀疏去噪的第二阶段，我们已经确定了曲波系数的**支撑集（Support Set）** $P$。现在的目标是消除 L1 正则化引入的幅度偏差，恢复信号的真实强度。

关键数学性质确认：
*   $\mathbf{d} \in \mathbb{R}^N$：观测图像。
*   $\mathcal{C}$：曲波正变换算子（$\mathbb{R}^N \to \mathbb{R}^M, M > N$）。
*   $\mathcal{C}^T$：曲波逆变换算子。
*   **性质 1 (紧框架)**：$\mathcal{C}^T \mathcal{C} = I$（图像域能量守恒，可完美重构）。
*   **性质 2 (过完备性)**：$\mathcal{C} \mathcal{C}^T \neq I$。由于 $M > N$，该算子是一个秩为 $N$ 的投影算子，且**非对角线元素不为零**。这意味着曲波系数之间存在不可忽略的相关性（Correlation）。

#### 2. 优化问题定义
既然支撑集 $P$（对角掩码算子）已知，我们需在由 $P$ 定义的子空间内，求解一个**限制最小二乘问题 (Restricted Least Squares Problem)**。

定义限制合成算子 $A$：
$$ A = \mathcal{C}^T P $$

优化目标为寻找最优系数 $x^*$：
$$ x^* = \arg\min_{x} \quad \frac{1}{2} \| \mathbf{d} - A x \|_2^2 $$
$$ \text{s.t.} \quad x_i = 0, \quad \forall i \notin P $$

#### 3. 正规方程与求解难点
对目标函数求导并令其为零，得到**正规方程 (Normal Equations)**：

$$ A^T A x = A^T \mathbf{d} $$

将其展开为算子形式（注意 $P^T = P$）：

$$ (P \mathcal{C} \mathcal{C}^T P) x = P \mathcal{C} \mathbf{d} $$

在此方程中：
*   右边 $P \mathcal{C} \mathbf{d}$ 是我们直接观测到的、被掩码截断的粗糙系数。
*   左边的核心算子 **$G_P = P \mathcal{C} \mathcal{C}^T P$** 是系数的**Gram 矩阵**在支撑集上的限制。
*   **重要结论**：由于 $\mathcal{C} \mathcal{C}^T \neq I$，算子 $G_P$ 不是对角矩阵。这意味着支撑集内的系数是**相互耦合 (Coupled)** 的。调整一个系数会影响其他系数的拟合效果，因此不能独立求解，**必须通过求解线性方程组来解耦**。

#### 4. 唯一的数值求解路径：迭代法
由于无法显式构建 $M \times M$ 的矩阵 $G_P$ 及其逆矩阵，我们必须采用**无矩阵 (Matrix-free)** 的迭代算法来求解上述线性系统 $G_P x = b$。

最常用的算法是 **共轭梯度法 (Conjugate Gradient, CG)** 或 **CGLS / LSQR**。

**算法流程描述：**
1.  定义线性算子函数 $\mathcal{A}(x) = \mathcal{C}^T(P(x))$。
2.  定义伴随算子函数 $\mathcal{A}^T(y) = P(\mathcal{C}(y))$。
3.  设定观测向量 $b = \mathbf{d}$。
4.  使用 CGLS 算法迭代求解 $x$：
    $$ \min_x \| b - \mathcal{A}(x) \|_2^2 $$
    
    在每次迭代中，算法会隐式地计算 $P \mathcal{C} \mathcal{C}^T P x$，从而逐步消除原子间的相关性，收敛到精确的最小二乘解。

此方法是数学上严谨的唯一解法，能有效消除重构图像中的振铃效应并精确恢复纹理细节。